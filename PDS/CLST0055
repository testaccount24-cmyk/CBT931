/* CLST0055  QUICK STATUS.                                          */
/* EXECUTES THE TSO COMMAND STATUS, CAPTURES THE DISPLAYED OUTPUT,  */
/* LOOPS THROUGH THE OUTPUT,                                        */
/* AND IF THE MESSAGE IS NO JOBS FOUND, IT EXITS                    */
/* IT LOOPS AGAIN, COUNTING THE NUMBER OF JOBS IN EACH STATUS       */
SET EXECUTING_CTR = 0
SET WAIT_CTR      = 0
SET OUTPUT_CTR    = 0
SET SYSOUTTRAP    = 100   /* ARBITRARILY CHOOSING 100 LINES. */
STATUS                 /* GET NAMES OF JOBS AND INFO ABOUT THEM */
SET SYSOUTTRAP    = 0              /* TURN OFF CAPTURING. */
SET MAX_RETURNED = &SYSOUTLINE  /* HOW MANY LINES RETURNED */
SET INDEX = 0
DO INDEX = 1 TO &MAX_RETURNED
        SET INDEX = &INDEX + 1         /* INCREMENT INDEX */
        SET CURRENT_LINE = &STR(&&SYSOUTLINE&INDEX) /* NOTE 2 */
        /* WRITE LINE RETRIEVED IS &STR(&CURRENT_LINE) */
        IF &SYSINDEX(NO JOBS FOUND,&CURRENT_LINE,1) GT 0 THEN +
        DO
            WRITE YOU HAVE NO JOBS IN THE SYSTEM NOW
            EXIT
        END /* NO JOBS FOUND */
 END /* END DO WHILE */
 SET INDEX = 0
 DO WHILE &INDEX LE &MAX_RETURNED       /* NOTE 1 */
         SET INDEX = &INDEX + 1         /* INCREMENT INDEX */
         SET CURRENT_LINE = &STR(&&SYSOUTLINE&INDEX) /* NOTE 2 */
         /* WRITE LINE RETRIEVED IS &STR(&CURRENT_LINE) */
                                                           /* NOTE 3 */
         IF &SYSINDEX(EXECUTING,&CURRENT_LINE,1) GT 0 THEN +
            SET EXECUTING_CTR = &EXECUTING_CTR + 1

         IF &SYSINDEX(OUTPUT QUEUE,&CURRENT_LINE,1) GT 0 THEN +
            SET OUTPUT_CTR = &OUTPUT_CTR + 1

         IF &SYSINDEX(WAITING FOR,&CURRENT_LINE,1) GT 0 THEN +
            SET WAIT_CTR = &WAIT_CTR + 1

END /* END DO WHILE */
 WRITE EXECUTING             &EXECUTING_CTR
 WRITE ON OUTPUT QUEUE       &OUTPUT_CTR
 WRITE WAITING FOR EXECUTION &WAIT_CTR



